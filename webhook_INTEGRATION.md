# Webhook Integration - Urban Mechanic Forwarding

This document describes the webhook we expect external sites to implement and how we will send forwarded "Find Nearby" notifications.

## Endpoint (to be provided by the external site)
- URL (example): `https://your-site.example.com/webhook/urbanmechanic`
- Method: `POST`
- Content-Type: `application/json`

## Payload
```json
{
  "message": "Find Nearby Mechanic button clicked!",
  "meta": { "lat": 19.07598, "lng": 72.87766 }
}
```

## Authentication (recommended)
- Option A: HMAC-SHA256 using a shared `NOTIFY_SECRET`.
  - Header: `X-Signature: sha256=<hex>`
  - The HMAC is computed over the raw request body bytes.
- Option B: API key header `X-API-Key: <key>` (not implemented server-side by us by default).

## Expected responses
- Success: HTTP 200 with `{ "success": true }` or just 200 OK.
- Failure: 4xx/5xx with JSON `{ "success": false, "error": "..." }`.

## Notes
- We will send the webhook from our server and expect a timely response (<5s).
- If you provide `NOTIFY_SECRET`, set it in our environment and we will sign requests accordingly.

## Testing
Example curl without signature:
```bash
curl -X POST 'https://your-site.example.com/webhook/urbanmechanic' \
  -H 'Content-Type: application/json' \
  -d '{"message":"Find Nearby Mechanic button clicked!","meta":{"lat":19.07598,"lng":72.87766}}'
```

Example curl with HMAC (assuming secret MY_SECRET):
1. Compute HMAC and send header:
```bash
BODY='{"message":"Find Nearby Mechanic button clicked!","meta":{"lat":19.07598,"lng":72.87766}}'
SIG=$(printf "%s" "$BODY" | openssl dgst -sha256 -hmac "MY_SECRET" -binary | xxd -p -c 256)
curl -X POST 'https://your-site.example.com/webhook/urbanmechanic' \
  -H 'Content-Type: application/json' \
  -H "X-Signature: sha256=$SIG" \
  -d "$BODY"
```

---
Generated by automation; update as needed for your partner.